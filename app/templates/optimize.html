{% extends "base.html" %}

{% block content %}
<section class="text-center py-10">
    <h1 class="text-3xl font-bold text-[#71A300]">Optimize Your Energy Usage</h1>
    <div class="mt-6 bg-white shadow-lg rounded-lg p-6">
        <!-- User Input Form -->
        <form id="optimizationForm" class="mb-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="electricity" class="block text-lg font-bold text-[#71A300]">Electricity Price (per kWh):</label>
                    <input type="number" id="electricity" name="electricity" class="w-full border border-gray-300 rounded p-2" placeholder="Enter electricity price">
                </div>
                <div>
                    <label for="naturalGas" class="block text-lg font-bold text-[#71A300]">Natural Gas Usage (therms):</label>
                    <input type="number" id="naturalGas" name="naturalGas" class="w-full border border-gray-300 rounded p-2" placeholder="Enter natural gas usage">
                </div>
                <div>
                    <label for="steam" class="block text-lg font-bold text-[#71A300]">Steam Usage (lbs):</label>
                    <input type="number" id="steam" name="steam" class="w-full border border-gray-300 rounded p-2" placeholder="Enter steam usage">
                </div>
                <div>
                    <label for="totalEnergy" class="block text-lg font-bold text-[#71A300]">Total Energy Usage (kWh):</label>
                    <input type="number" id="totalEnergy" name="totalEnergy" class="w-full border border-gray-300 rounded p-2" placeholder="Enter total energy usage">
                </div>
            </div>
            <button type="button" id="predictButton" class="mt-4 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">Predict & Optimize</button>
        </form>

        <!-- Prediction Chart -->
        <div class="chart-container mx-auto max-w-4xl">
            <canvas id="predictionChart" style="width:100%;max-width:800px;height:400px;"></canvas>
        </div>

        <!-- Suggestions -->
        <div id="suggestions" class="mt-6 bg-gray-100 shadow-md rounded-lg p-6 hidden">
            <h2 class="text-2xl font-bold text-[#71A300] mb-4">Optimization Suggestions</h2>
            <ul class="list-disc pl-6 text-left text-lg" id="suggestionList">
                <!-- Suggestions will be dynamically inserted here -->
            </ul>
        </div>
    </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    document.getElementById('predictButton').addEventListener('click', function () {
        // Simulated prediction data for demonstration
        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        const electricityData = months.map(() => Math.random() * 200);
        const naturalGasData = months.map(() => Math.random() * 150);
        const steamData = months.map(() => Math.random() * 100);
        const totalEnergyData = months.map(() => Math.random() * 300);

        // Update chart
        const ctx = document.getElementById('predictionChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: months,
                datasets: [
                    {
                        label: 'Electricity Price',
                        data: electricityData,
                        borderColor: 'blue',
                        backgroundColor: 'rgba(0, 0, 255, 0.1)',
                        fill: true,
                    },
                    {
                        label: 'Natural Gas Usage',
                        data: naturalGasData,
                        borderColor: 'yellow',
                        backgroundColor: 'rgba(255, 215, 0, 0.1)',
                        fill: true,
                    },
                    {
                        label: 'Steam Usage',
                        data: steamData,
                        borderColor: 'red',
                        backgroundColor: 'rgba(255, 0, 0, 0.1)',
                        fill: true,
                    },
                    {
                        label: 'Total Energy Usage',
                        data: totalEnergyData,
                        borderColor: 'green',
                        backgroundColor: 'rgba(0, 255, 0, 0.1)',
                        fill: true,
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top',
                    },
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Months',
                        },
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Usage / Price',
                        },
                    },
                },
            },
        });

        // Generate suggestions
        const suggestions = [
            'Lower heating settings during winter to save on natural gas.',
            'Switch to energy-efficient appliances to reduce electricity costs.',
            'Seal windows and doors to retain heat and reduce steam usage.',
            'Consider solar panels to offset total energy usage.'
        ];
        const suggestionList = document.getElementById('suggestionList');
        suggestionList.innerHTML = '';
        suggestions.forEach(suggestion => {
            const li = document.createElement('li');
            li.textContent = suggestion;
            suggestionList.appendChild(li);
        });

        // Show suggestions section
        document.getElementById('suggestions').classList.remove('hidden');
    });
</script>
{% endblock %}
